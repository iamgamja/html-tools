<!DOCTYPE HTML>
<html lang="ko">
  <head>
<!--     한영타, 영한타 -->
    <script src="e2k-k2e.js"></script>
<!--     md5 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<!--     brython -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython.js" integrity="sha256-rA89wPrTJJQFWJaZveKW8jpdmC3t5F9rRkPyBjz8G04=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython_stdlib.js" integrity="sha256-Gnrw9tIjrsXcZSCh/wos5Jrpn0bNVNFJuNJI9d71TDs=" crossorigin="anonymous"></script>
<!--     math.js -->
    <script src="https://unpkg.com/mathjs@9.3.0/lib/browser/math.js"></script>
    
    <script>
      check_md5 = 2;
      function md5(m) {
        m = m.toString()
        f = CryptoJS.MD5(m).toString()
        if (f.startsWith(f[0].repeat(check_md5))) {
          console.log(m, f)
          check_md5++;
        }
        return f
      }
      
      function chr(n) {
        return String.fromCharCode(n)
      }
      function ord(s) {
        return s.charCodeAt(0)
      }
      
      function set_table(table_id, value) {
        document.getElementById(table_id).innerHTML = '<pre>' + value + '</pre>';
        document.getElementById(table_id+'_').innerHTML = '<pre>' + md5(value) + '</pre>';
      }
      
      function shift_check() {
        if (event.keyCode == 16) { // 쉬프트 눌림
          if (shift === true) { // 연속 2번 눌렸다면
            // 조금 위험한 것들 실행(계산)
            set_table("계산값", math.evaluate(m));
            
            shift = false;
          } else {
            shift = true;
          }
        } else {
          shift = false;
        }
      }
      
      function click_table() {
        var s = event.target.innerHTML;
        if (s.startsWith("<pre>") && s.endsWith("</pre>")) {
          s = s.slice(5, -6)
        }
        document.getElementById("myTextarea").value = s
        main();
      }
      
      function main() {
        m = document.getElementById("myTextarea").value;
        
        set_table("기본값", m);
        set_table("글자수", m.length !== 0 ? m.length : "");
        set_table("한영타", gksdud(m));
        set_table("영한타", dudgks(m));
        set_table("영한영타", gksdud(dudgks(m)));
        set_table("한영한타", dudgks(gksdud(m)));
        set_table("반대로", m.split("").reverse().join(""));
        set_table("첫번째글자", m[0] !== undefined ? m[0] : "");
        set_table("마지막글자", m.slice(-1));
        
        document.getElementById("iframe1").src = "https://translate.google.com/?sl=auto&tl=ko&text=" + m + "&op=translate&hl=ko"
        document.getElementById("iframe2").src = "https://translate.google.com/?sl=auto&tl=en&text=" + m + "&op=translate&hl=ko"
      }
    </script>
  </head>
  
  <body>
    <form>
      <textarea id="myTextarea" autofocus placeholder="입력해보세요!" oninput="main();" onkeydown="shift_check();"></textarea><br>
    </form>
    <table id="table" border="1" onclick="click_table(event);">
      <tr>
        <td>기본값</td>
        <td id="기본값"></td>
        <td id="기본값_"></td>
      </tr>
      <tr>
        <td>글자수</td>
        <td id="글자수"></td>
        <td id="글자수_"></td>
      </tr>
      <tr>
        <td>한영타</td>
        <td id="한영타"></td>
        <td id="한영타_"></td>
      </tr>
      <tr>
        <td>영한타</td>
        <td id="영한타"></td>
        <td id="영한타_"></td>
      </tr>
      <tr>
        <td>영한영타</td>
        <td id="영한영타"></td>
        <td id="영한영타_"></td>
      </tr>
      <tr>
        <td>한영한타</td>
        <td id="한영한타"></td>
        <td id="한영한타_"></td>
      </tr>
      <tr>
        <td>반대로</td>
        <td id="반대로"></td>
        <td id="반대로_"></td>
      </tr>
      <tr>
        <td>첫번째글자</td>
        <td id="첫번째글자"></td>
        <td id="첫번째글자_"></td>
      </tr>
      <tr>
        <td>마지막글자</td>
        <td id="마지막글자"></td>
        <td id="마지막글자_"></td>
      </tr>
      <tr>
        <td>계산값</td>
        <td id="계산값"></td>
        <td id="계산값_"></td>
      </tr>
    </table>
    <iframe id="iframe1" src=""></iframe> <br>
    <iframe id="iframe2" src=""></iframe>
  </body>
</html>
