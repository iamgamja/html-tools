<!DOCTYPE HTML>
<html lang="ko"> <title>버전:2021-04-19 11:20 21.54</title>
  <head>
    <style>
      @font-face {
        font-family: 'fontemon';
        src: url(fontemon_small.otf) format('truetype');
      }
      body{
        -ms-overflow-style: none;
      }
 
      ::-webkit-scrollbar {
        display: none;
      }

      :not(button#command_button) {
        font-family: monospace;
      }
      td {
        cursor: pointer;
      }
      table {
        white-space: pre-line;
        word-break: break-all;
      }
      #vhsxmahs2 { /* #폰트몬2 */
        font-family: fontemon;
        font-size: 13px;
      }
      .custom-menu {
        z-index: 100;
        position: absolute;
        background-color: orange;
        border: 2px solid white;
        padding: 2px;
        font-family: monospace;
      }

      div#inputs {
        display: flex;
        align-items: center;
        padding: 0px;
        margin: 1px;
      }
      
      #myTextarea {
        display: none;
        margin: 1px;
        width: 50%;
      }

      #command_button {
        margin: 1px;
        width: 50%;
        height: 100%;
        display: inline-block;
        background:#1AAB8A;
        color:#fff;
        border:none;
        position:relative;
        font-size:1em;
        padding:0 2em;
        cursor:pointer;
        transition:800ms ease all;
        outline:none;
      }
      #command_button:hover{
        background:#fff;
        color:#1AAB8A;
      }
      #command_button:before, #command_button:after{
        content:'';
        position:absolute;
        top:0;
        right:0;
        height:2px;
        width:0;
        background: #1AAB8A;
        transition:400ms ease all;
      }
      #command_button:after{
        right:inherit;
        top:inherit;
        left:0;
        bottom:0;
      }
      #command_button:hover:before,#command_button:hover:after{
        width:100%;
        transition:800ms ease all;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--     한영타, 영한타 -->
    <script src="e2k-k2e.js"></script>
<!--     md5 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<!--     SHA256 -->
    <script src="SHA256.js"></script>
<!--     brython -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython.js" integrity="sha256-rA89wPrTJJQFWJaZveKW8jpdmC3t5F9rRkPyBjz8G04=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython_stdlib.js" integrity="sha256-Gnrw9tIjrsXcZSCh/wos5Jrpn0bNVNFJuNJI9d71TDs=" crossorigin="anonymous"></script>
<!--     math.js -->
    <script src="https://unpkg.com/mathjs@9.3.0/lib/browser/math.js"></script>
<!--     제이쿼리 -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<!--     jQuery animate colors -->
    <script src="https://cdn.jsdelivr.net/jquery.color-animation/1/mainfile"></script>
    
    <script>
      // 전역변수 설정
      var isS = false; // 우클릭시 true: sha256, false: md5
      var shift = false; // 쉬프트 키가 연속으로 눌렸는지를 감지하기 위한 변수
      // 끝
      
      function body_load() {
        // mobile command button
        var filter = "win16|win32|win64|mac|macintel";
        if ( navigator.platform ) {
          if ( filter.indexOf( navigator.platform.toLowerCase() ) < 0 ) {
            // mobile
            $("#command_button").show()
          } else {
            // pc
            $("#command_button").hide()
          }
        } else {
          alert("오류: 어떤 플랫폼으로 접속했는지 알 수 없음");
        }
        
        $("#myTextarea").show();
        $("#myTextarea")[0].focus();
        
        $("#inputs").css("height", `${Number($("#myTextarea").css("height").slice(0, -2))+6}px`) // margin, padding 길이(총 6px)만큼 추가.
                
        var table_items = ["기본값", "글자수", "한영타", "영한타", "영한영", "한영한", "반대로", "첫번째", "마지막", "계산값", "폰트몬", "이전수", "현재수", "다음수", "h2d", "d2h", "d2r", "r2d", "sin_d", "cos_d", "tan_d", "asin_d", "acos_d", "atan_d", "sin_r", "cos_r", "tan_r", "asin_r", "acos_r", "atan_r", "chr", "ord"]
        for (let i of table_items) {
          item = gksdud(i);
          let string_html = "";
          string_html += `<tr id="${item}">`
          string_html += `  <td id="${item}1"                     onmouseenter="all_spoiler();" onclick="click_event();">${i}</td>`
          string_html += `  <td id="${item}2"                     onmouseenter="all_spoiler();" onclick="click_event();">    </td>`
          string_html += `  <td id="${item}_"  class="md5Cell"    onmouseenter="see_spoiler();" onclick="click_event();">    </td>`
          string_html += `  <td id="${item}__" class="sha256Cell" onmouseenter="see_spoiler();" onclick="click_event();">    </td>`
          string_html += `</tr>`
          $("#table").html($("#table").html()+string_html);
        }
        
        $(gksdud("#계산값, #폰트몬")).hide();
        
        $(gksdud("#기본값1")).css("width", "42px");
        $(gksdud("#기본값_")).css("width", "49px"); // 224
        $(gksdud("#기본값__")).css("width", "49px"); // 448
        
        main();
        
        $(function() {
          $("*").bind("click", function(event) {
            $(".custom-menu").remove();
          });
          
          $("*").not("td, .custom-menu").bind("contextmenu", function(event) {
            event.preventDefault();
          });
          
          function right_click_event(event) {
            event.preventDefault();
            
            var find_text = $(event.currentTarget).attr('longHASH') || $(event.currentTarget).text()
            
            $(`<div class='custom-menu'>${isS ? sha256(find_text) : md5(find_text)}</div>`)
            .appendTo("#contentMenuDiv")
            .css({top: `${event.pageY}px`, left: `${event.pageX}px`})
            .bind("contextmenu", right_click_event)
            .bind("click", click_event);
          }
          
          $("td, .custom-menu").bind("contextmenu", right_click_event);
          
          
          // table setting
          $("#table").css("width", `${body.offsetWidth}px`); // 먼저 한번 설정하고 
          window.onresize = function() {
            $("#table").css("width", `${body.offsetWidth}px`); // 바뀔때마다 설정하기
          }
          console.log("script가 전부 로드되었습니다.");
        });
      } // body_load() end.
      
//       function set(id, value) {
//         return localStorage.setItem(id, JSON.stringify(value))
//       }
//       function get(id) {
//         return JSON.parse(localStorage.getItem(id))
//       }
      
      function true_calculator(s1, p, s2) {
        if (typeof s1 !== "string" || typeof s2 !== "string" ||
            /\D/.test(s1) || /\D/.test(s2)) {
          return NaN; // 입력값이 올바르지 않다면 NaN 출력
        }
        s1 = s1.replace(/^0+(?=.)/, ""); // 왼쪽0제거
        
        if (p === '+') { // 덧셈이다
          // 만약 js로 정확하게 계산할 수 있다면, 계산합니다.
          if (Number.isSafeInteger(Number(s1)+Number(s2))) return String(Number(s1)+Number(s2)).replace(/^0+(?=.)/, "") // 왼쪽0제거

          // 만약 js로 정확하게 계산할 수 없다면, 직접 계산합니다.
          if (s1.length === 0) return (s2).replace(/^0+(?=.)/, ""); // 앞자리가 비어있는데 올라갔다, 0 -> 1을 하므로 더한 수 반환, 왼쪽0제거
          if (s2.length !== 1) return true_calculator((true_calculator(s1.slice(0, -1), '+', s2.slice(0, -1)) + s1.slice(-1)), '+', s2.slice(-1)) // 앞자리끼리 계산, 뒤에 붙이고 다시 계산.
          if (parseInt(s1.slice(-1)) + parseInt(s2) > 9) { // 마지막자리끼리 더했더니 9보다 크다 = 마지막 둘째자리에 1을 더한다
            return (true_calculator(s1.slice(0, -1), '+', '1') +''+ (parseInt(s1.slice(-1)) + parseInt(s2) - 10)).replace(/^0+(?=.)/, "")
            //     ^앞자리에 1을 더한 것과                           ^마지막자리끼리 더한 수-10 (최종 1의 자리)       왼쪽0제거
          } else { // 아니면 그냥 뒷자리끼리만 계산
            return (s1.slice(0, -1) +''+ (parseInt(s1.slice(-1)) + parseInt(s2))).replace(/^0+(?=.)/, "")
            //     ^앞자리는 그대로       ^뒷자리끼리만 계산                        왼쪽0제거
          }
        } else if (p === '-') { // 뺄셈이다
          // 만약 js로 정확하게 계산할 수 있다면, 계산합니다.
          if (Number.isSafeInteger(Number(s1)-Number(s2))) return String(Number(s1)-Number(s2)).replace(/^0+(?=.)/, "") // 왼쪽0제거

          // 만약 js로 정확하게 계산할 수 없다면, 직접 계산합니다.
          if (s1.length === 0) return '-'+s2.replace(/^0+(?=.)/, ""); // 앞자리가 비어있는데 내려갔다, 0 -> -1을 하므로 '-'+더한 수 반환, 왼쪽0제거
          if (s2.length !== 1) return true_calculator((true_calculator(s1.slice(0, -1), '-', s2.slice(0, -1)) + s1.slice(-1)), '-', s2.slice(-1)) // 앞자리끼리 계산, 뒤에 붙이고 다시 계산.
          if (parseInt(s1.slice(-1)) - parseInt(s2) < 0) { // 마지막자리끼리 뺐더니 0보다 작다 = 마지막 둘째자리에 1을 뺀다
            return (true_calculator(s1.slice(0, -1), '-', '1') +''+ (parseInt(s1.slice(-1)) - parseInt(s2) + 10)).replace(/^0+(?=.)/, "")
            //     ^앞자리에 1을 뺀 것과                             ^마지막자리끼리 뺀 수+10 (최종 1의 자리)         왼쪽0제거
          } else { // 아니면 그냥 뒷자리끼리만 계산
            return (s1.slice(0, -1) +''+ (parseInt(s1.slice(-1)) - parseInt(s2))).replace(/^0+(?=.)/, "")
            //     ^앞자리는 그대로       ^뒷자리끼리만 계산                        왼쪽0제거
          }
        } else { // 지원하지 않는 기호
          return NaN;
        }
      }
      
      function md5(m) {  return CryptoJS.MD5(m.toString()).toString()  }
      function sha256(m) {  return SHA256(m.toString())  }
      function chr(n) {  return String.fromCharCode(n)  }
      function ord(s) {  return s.charCodeAt(0)  }
      function d2r(d) {  return d * Math.PI / 180  }
      function r2d(r) {  return r / Math.PI * 180  }
      function h2d(h) {  return parseInt(String(h), 16)  }
      function d2h(d) {  return Number(d).toString(16)  }
      
      function command_check() {
        var m = gksdud($("#myTextarea").val());
        if (m.startsWith("/")) {
          m = m.slice(1).split(' ');

          if (m[0].startsWith("see")) {
            if (m[1].startsWith("hide")) {
              $(m[2]).hide();
            } else if (m[1].startsWith("show")) {
              $(m[2]).show();
            } else if (m[1].startsWith("toggle")) {
              $(m[2]).toggle();
            }
            main();
          } else if (m[0].startsWith("hash")) { // 우클릭 팝업창 hash 종류
            if (m[1].startsWith("sha")) { // sha256
              isS = true;
            } else if (m[1].startsWith("md")) { // md5
              isS = false;
            } else if (m[1].startsWith("toggle")) {
              isS = !isS;
            }
          } else if (m[0].startsWith("ele")) { // elements
            if (m[1].startsWith("add")) {
              $("div#add_elements").append(`<${m[2]} id="${m[3].replaceAll('"', '')}">${m[4]}</${m[2]}>`);
            } else if (m[1].startsWith("css")) {
              $(`div#add_elements ${m[2]}`).css(m[3], m[4]);
            } else if (m[1].startsWith("del")) {
              $(`div#add_elements ${m[2]}`).remove();
            } else if (m[1].startsWith("clear")) { // clear
              $("div#add_elements").empty();
            }
          } else if (m[0].startsWith("title")) {
            $("title").text(m.slice(1).join(' '));
          } else if (m[0].startsWith("reload")) {
            history.go(0);
          }
            
          // animate
          $("#myTextarea").animate({
            backgroundColor: '#ffff00'
          }, 200, 'swing', function() {
            $(this).animate({
              backgroundColor: '#ffffff'
            }, 900);
          });
        }
        $("#myTextarea")[0].focus()
      }

      function shift_check() {
        if (event.keyCode == 16) { // 쉬프트 눌림
          if (shift) { // 연속 2번 눌렸다면
            shift = false;
            // 조금 위험한 것들 실행(명령어)
            command_check();
          } else { // 이전에 눌리지 않았을때
            shift = true;
          }
        } else { // 쉬프트가 아닐때
          shift = false;
        }
      }
      
      function click_event() {
        $("#myTextarea").val($(event.currentTarget).attr('longHASH') || $(event.currentTarget).text());
        main();
        $("#myTextarea")[0].focus();
      }
      
      function set_see(ele) {
        $(ele).text($(ele).attr('longHASH'));
      }
      function set_not_see(ele) {
        $(ele).text($(ele).attr('shortHASH'));
      }
      
      function see_spoiler() {
        var e = $(event.currentTarget);
        $("#table td").filter(".md5Cell, .sha256Cell").each(function (index, item) { // hash cell에서만 반복
          set_not_see(item);
        });
        set_see(e)
        if (e.hasClass("md5Cell")) {
          $(gksdud("#기본값_")).css("width", "224px");
          $(gksdud("#기본값__")).css("width", "49px");
        } else {
          $(gksdud("#기본값__")).css("width", "448px");
          $(gksdud("#기본값_")).css("width", "49px");
        }
      }
      
      function all_spoiler() {
        $("#table td").filter(".md5Cell, .sha256Cell").each(function (index, item) { // hash cell에서만 반복
          set_not_see(item)
        });
        $(gksdud("#기본값_")).css("width", "49px");
        $(gksdud("#기본값__")).css("width", "49px");
      }
      
      function set_table(table_id, value) {
        if (value === undefined) value = ""
        if ($(gksdud(`#${table_id}`)).css('display') === "none") return; // 만약 안보인다면 굳이 설정할 필요 없음.
        $(gksdud(`#${table_id}2`)).text(value);
        
        $(gksdud(`#${table_id}_`))
          .attr("shortHASH", `${md5(value).slice(0, 2)}...${md5(value).slice(-2)}`)
          .attr("longHASH", md5(value));
        set_not_see($(gksdud(`#${table_id}_`)));
        
        $(gksdud(`#${table_id}__`))
          .attr("shortHASH", `${sha256(value).slice(0, 2)}...${sha256(value).slice(-2)}`)
          .attr("longHASH", sha256(value));
        set_not_see($(gksdud(`#${table_id}__`)));
      }
      
      function main() {
        var m = $("#myTextarea").val() || "";

        set_table("기본값", m);
        set_table("글자수", m.length || "");
        set_table("한영타", gksdud(m));
        set_table("영한타", dudgks(m));
        set_table("영한영", gksdud(dudgks(m)));
        set_table("한영한", dudgks(gksdud(m)));
        set_table("반대로", m.split("").reverse().join(""));
        set_table("첫번째", m[0]);
        set_table("마지막", m.slice(-1));
        set_table("폰트몬", m);
        set_table("이전수", m ? true_calculator(m, '-', '1') : '');
        set_table("현재수", m ? true_calculator(m, '+', '0') : '');
        set_table("다음수", m ? true_calculator(m, '+', '1') : '');
        set_table("h2d", m ? h2d(m) : "");
        set_table("d2h", m ? d2h(m) : "");
        set_table("d2r", m ? d2r(Number(m)) : "");
        set_table("r2d", m ? r2d(Number(m)) : "");
        set_table("sin_d", m ? Math.sin(d2r(Number(m))) : ""); // 입력된 값을 d로 인식, r로 변환.
        set_table("cos_d", m ? Math.cos(d2r(Number(m))) : "");
        set_table("tan_d", m ? Math.tan(d2r(Number(m))) : "");
        set_table("asin_d", m ? r2d(Math.asin(m)) : ""); // Math는 r을 반환하므로 d로 변환.
        set_table("acos_d", m ? r2d(Math.acos(m)) : "");
        set_table("atan_d", m ? r2d(Math.atan(m)) : "");
        set_table("sin_r", m ? Math.sin(m) : ""); // 여기서부터는 r로만 입출력.
        set_table("cos_r", m ? Math.cos(m) : "");
        set_table("tan_r", m ? Math.tan(m) : "");
        set_table("asin_r", m ? Math.asin(m) : "");
        set_table("acos_r", m ?  Math.acos(m) : "");
        set_table("atan_r", m ? Math.atan(m) : "");
        set_table("chr", m ? chr(parseInt(m)) : "");
        set_table("ord", m ? ord(m) : "");
        
        try {
          set_table("계산값", math.evaluate(m));
        } catch(e) {
          set_table("계산값", e);
        }
      }
    </script>
  </head>
  
  <body id="body" onkeydown="shift_check();" onload="body_load();">
    <form>
      <div id="inputs">
        <textarea id="myTextarea" placeholder="입력해보세요!" oninput="main();" onfocus="this.value = this.value;"></textarea>
        <button id="command_button" type="button" onclick="command_check();" style="display: none;">click here!</button>
      </div> <br>
    </form>
    <table id="table" border="1" onmouseleave="all_spoiler();"></table><br>
    <div id="add_elements"></div>
    <div id="contentMenuDiv"></div>
  </body>
</html>
