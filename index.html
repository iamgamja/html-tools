<!DOCTYPE HTML>
<html lang="ko">
  <head>
    <script src="e2k-k2e.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script>
//       chr(Math.round(Math.random()*0x110000))
      mac = false;
      check_md5 = 2;
      function md5(m) {
        m = m.toString()
        f = CryptoJS.MD5(m).toString()
        if (f.startsWith(f[0].repeat(check_md5))) {
          console.log(m, f)
          check_md5++;
        }
        return f
      }
      
      function chr(n) {
        return String.fromCharCode(n)
      }
      function ord(s) {
        return s.charCodeAt(0)
      }
      
      function shift_check() {
        if (event.keyCode == 16) { // 쉬프트 눌림
          if (shift === true) { // 연속이라면 매크로 실행
            mac = !mac;
            shift = false;
          } else {
            shift = true;
          }
        } else {
          shift = false;
        }
        if (mac) {
          document.getElementById("myTextarea").value += chr(Math.round(Math.random()*0x110000)); // 랜덤한 유니코드 문자를 더한다.
        }
      }
      
      function click_table() {
        var s = event.target.innerHTML;
        if (s.startsWith("<pre>") && s.endsWith("</pre>")) {
          s = s.slice(5, -6)
        }
        document.getElementById("myTextarea").value = s
        main();
      }
      
      function main() {
        m = document.getElementById("myTextarea").value;
        function set_table(table_id, value) {
          document.getElementById(table_id).innerHTML = '<pre>' + value + '</pre>';
          document.getElementById(table_id+'_').innerHTML = '<pre>' + md5(value) + '</pre>';
        }
        
        set_table("기본값", m);
        set_table("글자수", m.length !== 0 ? m.length : "");
        set_table("한영타", gksdud(m));
        set_table("영한타", dudgks(m));
        set_table("영한영타", gksdud(dudgks(m)));
        set_table("한영한타", dudgks(gksdud(m)));
        set_table("반대로", m.split("").reverse().join(""));
        set_table("첫번째글자", m[0] !== undefined ? m[0] : "");
        set_table("마지막글자", m.slice(-1));
      }
    </script>
  </head>
  
  <body>
    <form>
      <textarea id="myTextarea" autofocus placeholder="입력해보세요!" oninput="main();" onkeydown="shift_check();"></textarea><br>
    </form>
    <table id="table" border="1" onclick="click_table(event);">
      <tr>
        <td>기본값</td>
        <td id="기본값"></td>
        <td id="기본값_"></td>
      </tr>
      <tr>
        <td>글자수</td>
        <td id="글자수"></td>
        <td id="글자수_"></td>
      </tr>
      <tr>
        <td>한영타</td>
        <td id="한영타"></td>
        <td id="한영타_"></td>
      </tr>
      <tr>
        <td>영한타</td>
        <td id="영한타"></td>
        <td id="영한타_"></td>
      </tr>
      <tr>
        <td>영한영타</td>
        <td id="영한영타"></td>
        <td id="영한영타_"></td>
      </tr>
      <tr>
        <td>한영한타</td>
        <td id="한영한타"></td>
        <td id="한영한타_"></td>
      </tr>
      <tr>
        <td>반대로</td>
        <td id="반대로"></td>
        <td id="반대로_"></td>
      </tr>
      <tr>
        <td>첫번째글자</td>
        <td id="첫번째글자"></td>
        <td id="첫번째글자_"></td>
      </tr>
      <tr>
        <td>마지막글자</td>
        <td id="마지막글자"></td>
        <td id="마지막글자_"></td>
      </tr>
    </table>
  </body>
</html>
