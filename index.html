<!DOCTYPE HTML>
<html lang="ko"> 버전:2021-04-12 09:45 20.3
  <head>
    <style>
      @font-face {
        font-family: 'fontemon';
        src: url(fontemon_small.otf) format('truetype');
      }
      td {
        cursor: pointer;
      }
      table {
        font-family: monospace;
        white-space: pre-line;
        word-break: break-all;
      }
      #vhzptahs2 { /* #포켓몬2 */
        font-family: fontemon;
        font-size: 13px;
      }
      .custom-menu {
        z-index: 100;
        position: absolute;
        background-color: orange;
        border: 2px solid white;
        padding: 2px;
        font-family: monospace;
      }

      div#inputs {
        display: flex;
        align-items: center;
        padding: 0px;
        margin: 1px;
      }
      
      #myTextarea {
        margin: 1px;
        width: 50%;
      }

      #command_button {
        margin: 1px;
        width: 50%;
        height: 100%;
        display: inline-block;
        background:#1AAB8A;
        color:#fff;
        border:none;
        position:relative;
        font-size:1em;
        padding:0 2em;
        cursor:pointer;
        transition:800ms ease all;
        outline:none;
      }
      #command_button:hover{
        background:#fff;
        color:#1AAB8A;
      }
      #command_button:before, #command_button:after{
        content:'';
        position:absolute;
        top:0;
        right:0;
        height:2px;
        width:0;
        background: #1AAB8A;
        transition:400ms ease all;
      }
      #command_button:after{
        right:inherit;
        top:inherit;
        left:0;
        bottom:0;
      }
      #command_button:hover:before,#command_button:hover:after{
        width:100%;
        transition:800ms ease all;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--     한영타, 영한타 -->
    <script src="e2k-k2e.js"></script>
<!--     md5 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<!--     SHA256 -->
    <script src="SHA256.js"></script>
<!--     brython -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython.js" integrity="sha256-rA89wPrTJJQFWJaZveKW8jpdmC3t5F9rRkPyBjz8G04=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython_stdlib.js" integrity="sha256-Gnrw9tIjrsXcZSCh/wos5Jrpn0bNVNFJuNJI9d71TDs=" crossorigin="anonymous"></script>
<!--     math.js -->
    <script src="https://unpkg.com/mathjs@9.3.0/lib/browser/math.js"></script>
<!--     제이쿼리 -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<!--     jQuery animate colors -->
    <script src="https://cdn.jsdelivr.net/jquery.color-animation/1/mainfile"></script>
    
    <script>
      // 변수 설정
      isS = false; // 전역변수, true: sha256, false: md5
      shift = false; // 전역변수, 쉬프트 키가 연속으로 눌렸는지를 감지하기 위한 변수
      special_md5 = get("special_md5"); // 전역변수, 특별한 md5 값 저장된 json
      special_sha256 = get("special_sha256"); // 전역변수, 특별한 sha256 값 저장된 json
      // 끝
      
      function body_load() {
        
        // mobile command button
        var filter = "win16|win32|win64|mac|macintel";
        if ( navigator.platform ) {
          if ( filter.indexOf( navigator.platform.toLowerCase() ) < 0 ) {
            // mobile
            $("#command_button").show()
          } else {
            // pc
            $("#command_button").hide()
          }
        } else {
          alert("오류: 어떤 플랫폼으로 접속했는지 알 수 없음");
        }
        $("#inputs").css("height", `${Number($("#myTextarea").css("height").slice(0, -2))+6}px`) // margin, padding 길이(총 6px)만큼 추가.
        
        // table setting
        $("#table").css("width", `${body.offsetWidth}px`); // 먼저 한번 설정하고 
        window.onresize = function() {
          $("#table").css("width", `${body.offsetWidth}px`); // 바뀔때마다 설정하기
        }
        
        var table_html = ""
        var table_items = ["기본값", "글자수", "한영타", "영한타", "영한영", "한영한", "반대로", "첫번째", "마지막", "계산값", "포켓몬"]
        for (let i of table_items) {
          item = gksdud(i);
          table_html += `<tr id="${item}"><td id="${item}1" onclick="click_event();">${i}</td><td id="${item}2" onclick="click_event();"></td><td id="${item}_" onmouseenter="see_spoiler();" onclick="click_event();"></td><td id="${item}__" onmouseenter="see_spoiler();" onclick="click_event();"></td></tr>`
        }
        table.innerHTML += table_html;
        
        $(gksdud("#계산값")).hide();
        
        $("th1").css("width", "42px");
        $("th3").css("width", "49px"); // 224
        $("th4").css("width", "49px"); // 448
        
        main();
        
        console.log("javaScript가 전부 로드되었습니다.");
        
        $(function() {
          $("*").bind("click", function(event) {
            $(".custom-menu").remove();
          });
          
          $("*").not("td, .custom-menu").bind("contextmenu", function(event) {
            event.preventDefault();
          });
          
          function right_click_event(event) {
            event.preventDefault();
            
            var find_text = ""; // 초기화
            if (event.currentTarget.childNodes[1]) {
              find_text = event.currentTarget.childNodes[1].nodeValue;
            } else if (event.currentTarget.childNodes[0]) {
              find_text = event.currentTarget.childNodes[0].nodeValue;
            }
            
            $(`<div class='custom-menu'>${isS ? sha256(find_text) : md5(find_text)}</div>`)
            .appendTo("#contentMenuDiv")
            .css({top: (event.pageY) + "px", left: (event.pageX + "px")})
            .bind("contextmenu", right_click_event)
            .bind("click", click_event);
          }
          
          $("td, .custom-menu").bind("contextmenu", right_click_event);
          
          console.log("jQuery가 전부 로드되었습니다.");

        });
      }
      
      function set(id, value) {
        return localStorage.setItem(id, JSON.stringify(value))
      }
      function get(id) {
        return JSON.parse(localStorage.getItem(id))
      }
      function reset_specials() {
        set("special_md5", false);
        set("special_sha256", false);
        location.reload();
      }
      
      if (!special_md5) {
        special_md5 = {}
        for (let i=3; i<=16; i++) {
          special_md5[i.toString()] = {}
        }
        special_md5["mirror"] = {}
        set("special_md5", special_md5)
      }
      
      if (!special_sha256) {
        special_sha256 = {}
        for (let i=3; i<=64; i++) {
          special_sha256[i.toString()] = {}
        }
        special_sha256["mirror"] = {}
        set("special_sha256", special_sha256)
      }
      
      function md5(m) {
        var m = m.toString()
        var f = CryptoJS.MD5(m).toString()
        
        for (let i=2; i<=16; i++) {
          if (!f.startsWith(f[0].repeat(i))) {
            var same_number = i-1;
            break
          }
        }
        if (same_number > 3) { // 앞자리 일부가 겹치면
          if (!(m in special_md5[same_number.toString()])) { // 새로운 문자라면
            console.log(`%c새로운 문자를 발견했습니다! (md5 앞 ${same_number}자리가 겹침) %c\n${m} => \n${f}`, "background:lime;color:green;", "background:white;color:black;"); // 알려주고
            special_md5[same_number.toString()][m] = f; // json에 추가
            set("special_md5", special_md5); // 저장
          }
        } else if (f.split("").reverse().join("") === f) { // 뒤집어도 같다면
          if (!(m in special_md5["mirror"])) { // 새로운 문자라면
            console.log(`%c새로운 문자를 발견했습니다! (md5 뒤집어도 같음) %c\n${m} => \n${f}`, "background:lime;color:green;", "background:white;color:black;"); // 알려주고
            special_md5["mirror"][m] = f; // json에 추가
            set("special_md5", special_md5); // 저장
          }
        }
        return f
      }
      
      function sha256(m) {
        var m = m.toString()
        var f = SHA256(m)
        
        for (let i=2; i<=64; i++) {
          if (!f.startsWith(f[0].repeat(i))) {
            var same_number = i-1;
            break
          }
        }
        if (same_number > 3) { // 앞자리 일부가 겹치면
          if (!(m in special_sha256[same_number.toString()])) { // 새로운 문자라면
            console.log(`%c새로운 문자를 발견했습니다! (sha256 앞 ${same_number}자리가 겹침) %c\n${m} => \n${f}`, "background:lime;color:green;", "background:white;color:black;"); // 알려주고
            special_sha256[same_number.toString()][m] = f; // json에 추가
            set("special_sha256", special_sha256); // 저장
          }
        } else if (f.split("").reverse().join("") === f) { // 뒤집어도 같다면
          if (!(m in special_sha256["mirror"])) { // 새로운 문자라면
            console.log(`%c새로운 문자를 발견했습니다! (sha256 뒤집어도 같음) %c\n${m} => \n${f}`, "background:lime;color:green;", "background:white;color:black;"); // 알려주고
            special_sha256["mirror"][m] = f; // json에 추가
            set("special_sha256", special_sha256); // 저장
          }
        }
        return f
      }

      function chr(n) {
        return String.fromCharCode(n)
      }
      function ord(s) {
        return s.charCodeAt(0)
      }

      function set_table(table_id, value) {
        $('#'+gksdud(table_id)+'2')[0].innerHTML = value;
        $('#'+gksdud(table_id)+'_')[0].innerHTML = `<!--${md5(value)}-->${md5(value).slice(0, 2)}...${md5(value).slice(-2)}`;
        $('#'+gksdud(table_id)+'__')[0].innerHTML = `<!--${sha256(value)}-->${sha256(value).slice(0, 2)}...${sha256(value).slice(-2)}`;
      }
      
      function command_check() {
        var m = gksdud($("#myTextarea")[0].value);
        if (m.startsWith("/")) {
          m = m.slice(1).split(' ');

          var is_command = true; // 지역변수, 커맨드가 사용되었는지 나타내는 변수
          if (m[0].startsWith("h")) { // hide
            $('#'+m[1]).hide();
          } else if (m[0].startsWith("s")) { // show
            $('#'+m[1]).show();
          } else if (m[0].startsWith("t")) { // toggle
            $('#'+m[1]).toggle();
          } else if (m[0].startsWith("r")) { // right click setting
            if (m[1].startsWith("s")) { // sha256
              isS = true;
            } else if (m[1].startsWith("m")) { // md5
              isS = false;
            } else if (m[1].startsWith("t")) { // toggle
              isS = !isS;
            } else { // not command
              is_command = false;
            }
          } else { // not command
            is_command = false;
          }
          if (is_command) { // 커맨드를 실행했다면
            $("#myTextarea").animate({
              backgroundColor: '#ffff00'
            }, 200, 'swing', function() {
              $(this).animate({
                backgroundColor: '#ffffff'
              }, 900);
            });
          }
        }
      }
      

      function shift_check(cmd) {
        if (event.keyCode == 16) { // 쉬프트 눌림
          if (shift) { // 연속 2번 눌렸다면
            shift = false;
            // 조금 위험한 것들 실행(명령어)
            command_check();
          } else { // 이전에 눌리지 않았을때
            shift = true;
          }
        } else { // 쉬프트가 아닐때
          shift = false;
        }
      }
      
      function get_c1(ele) {
        return ele.childNodes[0].nodeValue // 주석 내용
      }
      function get_c2(ele) {
        return ele.childNodes[1].nodeValue // 주석을 제외한 모든 내용
      }
      
      function click_event() {
        if (!event.target.id.endsWith("_")) {
          $("#myTextarea")[0].value = event.target.innerHTML;
        } else {
          var c1 = get_c1(event.target)
          var c2 = get_c2(event.target)
          $("#myTextarea")[0].value = c1.length > c2.length ? c1 : c2 // 더 긴(원래 hash) 값을 넣는다
        }
        main();
        $("#myTextarea")[0].focus();
      }
      
      function set_see_spoiler(ele) {
        var c1 = get_c1(ele)
        var c2 = get_c2(ele)
        if (c1.length < c2.length) return; // 이미 보인다면 리턴
        ele.innerHTML = `<!--${c2}-->${c1}`
      }
      function set_not_see_spoiler(ele) {
        var c1 = get_c1(ele)
        var c2 = get_c2(ele)
        if (c1.length > c2.length) return; // 이미 안보인다면 리턴
        ele.innerHTML = `<!--${c2}-->${c1}`
      }
      
      function see_spoiler() {
        set_see_spoiler(event.currentTarget);
        var trs = $("#table")[0].childNodes[0].childNodes; // tr 여러개
        for (let tr of trs) {
          var tds = tr.childNodes; // td 2개
          for (let td of tds) {
            if (td.id.endsWith("_") && td !== event.currentTarget) {
              set_not_see_spoiler(td);
            }
          }
        }
        if (!event.currentTarget.id.endsWith("__")) { // md5
          $("th3").css("width", "224px");
          $("th4").css("width", "49px");
        } else { // sha256
          $("th3").css("width", "49px");
          $("th4").css("width", "448px");
        }
      }
      
      function all_spoiler() {
        var trs = table.childNodes[0].childNodes; // tr 여러개
        for (let tr of trs) {
          var tds = tr.childNodes; // td 2개
          for (let td of tds) {
            if (td.id.endsWith("_")) {
              set_not_see_spoiler(td);
            }
          }
        }
        $("th3").css("width", "49px");
        $("th4").css("width", "49px");
      }

      function main() {
        var m = $("#myTextarea")[0].value || "";

        set_table("기본값", m);
        set_table("글자수", m.length || "");
        set_table("한영타", gksdud(m));
        set_table("영한타", dudgks(m));
        set_table("영한영", gksdud(dudgks(m)));
        set_table("한영한", dudgks(gksdud(m)));
        set_table("반대로", m.split("").reverse().join(""));
        set_table("첫번째", m[0] || "");
        set_table("마지막", m.slice(-1));
        if ($(gksdud("#계산값")).css("display") !== "none") { // 계산값 줄 자체가 보이지 않는다면 굳이 할필요 없음
          try {
            set_table("계산값", m ? math.evaluate(m) : "");
          } catch(e) {
            set_table("계산값", e);
          }
        } else { // 기본 틀은 맞춰야 하기 때문에 빈 값 세팅
          set_table("계산값", "");
        }
        set_table("포켓몬", m);
      }
    </script>
  </head>
  
  <body id="body" onkeydown="shift_check();" onload="body_load();">
    <form>
      <div id="inputs">
        <textarea id="myTextarea" autofocus placeholder="입력해보세요!" oninput="main();" onfocus="this.value = this.value;"></textarea>
        <button id="command_button" type="button" onclick="command_check();" style="display: none;">click here!</button>
      </div> <br>
    </form>
    <table id="table" border="1" onmouseleave="all_spoiler();"> </table>
    <div id="contentMenuDiv"></div>
  </body>
</html>
